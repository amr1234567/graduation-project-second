<div class="new-arrivals-section">
  <h1>New Arrivals</h1>
  <p class="subtitle">Check out most promising product bought by our buyers</p>

  <div class="navigations">
    <div class="nav-item" [class.active]="categoryId() == ''" (click)="getRouteForCategory('')">
      All
    </div>
    @for (category of categories(); track category.id){
    <div class="nav-item" [class.active]="categoryId() == category.id" (click)="getRouteForCategory(category.id)">
      {{category.name}}
    </div>
    }
    </div>
  <div class="products-wrapper">
    <button class="arrow-btn prev-btn" [class.disabled]="page() <= 1" (click)="onBack()">
      <svg width="27" height="17" viewBox="0 0 27 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M2.26855 8.64614L1.56145 7.93903L0.854341 8.64614L1.56145 9.35325L2.26855 8.64614ZM25.0224 9.64614C25.5747 9.64614 26.0224 9.19842 26.0224 8.64614C26.0224 8.09385 25.5747 7.64614 25.0224 7.64614V9.64614ZM9.14606 0.354417L1.56145 7.93903L2.97566 9.35325L10.5603 1.76863L9.14606 0.354417ZM1.56145 9.35325L9.14606 16.9379L10.5603 15.5236L2.97566 7.93903L1.56145 9.35325ZM2.26855 9.64614H25.0224V7.64614H2.26855V9.64614Z"
          fill="#323232" />
      </svg>
    </button>

    <div class="products-container">
      @for (product of productsShown; track product.productId) {
      <div class="product-card">
        <div class="product-image">
          <img [src]="product.pictureUrl" [alt]="product.name">
          <div class="product-actions">
            <button class="action-btn favorite" [class.active]="product.isInFav" (click)="toggleFavorite(product)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                  fill="none" stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <button class="action-btn cart" [class.active]="product.isInCart" (click)="addToCart(product)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                <path
                  d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                <path
                  d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>
          </div>
        </div>
        <div class="product-info">
          <h3 class="product-name">{{product.name}}</h3>
          <p class="product-category">{{product.categoryName}}</p>
          <div class="product-rating">
            @for (star of getStarsForProduct(product.rate); track $index){
            <span class="star" [class.filled]="star">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M8 1.33301L10.06 5.50634L14.6667 6.17967L11.3333 9.42634L12.12 14.013L8 11.8463L3.88 14.013L4.66667 9.42634L1.33333 6.17967L5.94 5.50634L8 1.33301Z"
                  [attr.fill]="star ? '#FBD103' : 'none'" stroke="#FBD103" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </span>
            }
          </div>
          <div class="product-price">
            ${{product.price.toFixed(2)}}
          </div>
          </div>
          </div>
          } @empty {
      <div class="no-products">
        No new arrivals for the current category
      </div>
      }
    </div>
    <button class="arrow-btn next-btn" [class.disabled]="page() * 4 >= products().data.length" (click)="onNext()">
      <svg width="27" height="17" viewBox="0 0 27 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M24.7314 8.64614L25.4386 7.93903L26.1457 8.64614L25.4386 9.35325L24.7314 8.64614ZM1.9776 9.64614C1.42532 9.64614 0.9776 9.19842 0.9776 8.64614C0.9776 8.09385 1.42532 7.64614 1.9776 7.64614V9.64614ZM17.8539 0.354417L25.4386 7.93903L24.0243 9.35325L16.4397 1.76863L17.8539 0.354417ZM25.4386 9.35325L17.8539 16.9379L16.4397 15.5236L24.0243 7.93903L25.4386 9.35325ZM24.7314 9.64614H1.9776V7.64614H24.7314V9.64614Z"
          fill="#323232" />
      </svg>
    </button>
  </div>
  </div>